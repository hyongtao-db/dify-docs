# 繰り返し処理（ループ）

繰り返し処理（ループ）ノードは、前回の結果に依存する反復タスクを実行し、終了条件を満たすか最大繰り返し回数に達するまで継続します。

## 繰り返し処理ノードと反復処理ノードの違い

繰り返し処理ノードと反復処理ノードは、タスクの処理方法に違いがあります。

<table>
  <thead>
    <tr>
      <th>タイプ</th>
      <th>特徴</th>
      <th>適用シーン</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>繰り返し処理（ループ）</strong></td>
      <td>各回の処理が前回の結果に依存する。</td>
      <td>再帰処理や最適化問題など、前回の計算結果を必要とする処理に適している。</td>
    </tr>
    <tr>
      <td><strong>反復処理（イテレーション）</strong></td>
      <td>各回の処理は独立しており、前回の結果に依存しない。</td>
      <td>データの一括処理など、各処理を独立して実行できるタスクに適している。</td>
    </tr>
  </tbody>
</table>

## 繰り返し処理（ループ）ノードの設定方法

繰り返し処理ノードには、以下の2つの重要な設定項目があります。

<table>
  <thead>
    <tr>
      <th>設定項目</th>
      <th>目的</th>
      <th>例</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>終了条件（Loop Termination Condition）</strong></td>
      <td>繰り返し処理をいつ停止するかを設定。</td>
      <td>例：変数 <code>x < 50</code> の場合にループを停止。</td>
    </tr>
    <tr>
      <td><strong>最大繰り返し回数（Maximum Loop Count）</strong></td>
      <td>無限ループを防ぐため、実行する最大繰り返し回数を制限。</td>
      <td>例：最大 10 回まで実行し、条件に関わらず停止。</td>
    </tr>
  </tbody>
</table>

終了条件では、ループ内の変数やセッションのグローバル変数を指定でき、柔軟な終了判定が可能です。

![configuration](https://assets-docs.dify.ai/2025/03/13853bfaaa068cdbdeba1b1f75d482f2.png)

## 使用例：繰り返し処理（ループ）ノードの活用

**要件：1 から 100 までのランダムな数値を生成し、その数値が 50 未満になるまで繰り返し処理を行う。**

**実装手順**：

1. `code` ノードを使用して `1-100` のランダムな数値を生成。

2. `if` ノードを使用して、生成された数値が `50` 未満かどうかを判定：
   - 50 未満の場合 → `done` を出力し、ループを終了。
   - 50 以上の場合 → ループを継続し、新しいランダムな数値を生成。

3. 終了条件の設定：ランダムな数値 `< 50`。

4. ランダムな数値が `50` 未満になると、ループは自動的に停止。

![case_steps](https://assets-docs.dify.ai/2025/03/b1c277001fc3cb1fbb85fe7c22a6d0fc.png)

## 今後の拡張

**今後のバージョンでは、以下の機能を提供予定：**

- ループ変数：繰り返し処理中に変数を保存・参照できる機能。より複雑なロジック制御が可能に。

- `break` ノード：ループの途中でも特定の条件で処理を中断できる機能。より高度なフロー制御を実現。
